[2025-10-16 20:27:49][RANK 0][INFO] Initializing Dataloaders...
[2025-10-16 20:27:49][RANK 0][INFO] Dataloaders initialized.
[2025-10-16 20:27:50][RANK 0][INFO] Starting training for RNN model...
[2025-10-16 20:27:50][RANK 0][INFO] Starting Epoch 1/35
[2025-10-16 21:13:14][RANK 0][INFO] Starting validation...
[2025-10-16 21:20:33][RANK 0][INFO] EPOCH 1 SUMMARY: Val Loss: 0.6281 | Val Acc: 0.7848
[2025-10-16 21:20:33][RANK 0][INFO] New best val_acc: 0.7848. Saving model...
[2025-10-16 21:20:35][RANK 0][INFO] Starting Epoch 2/35
[2025-10-16 22:04:18][RANK 0][INFO] Starting validation...
[2025-10-16 22:12:47][RANK 0][INFO] EPOCH 2 SUMMARY: Val Loss: 0.5524 | Val Acc: 0.8226
[2025-10-16 22:12:47][RANK 0][INFO] New best val_acc: 0.8226. Saving model...
[2025-10-16 22:12:48][RANK 0][INFO] Starting Epoch 3/35
[2025-10-16 22:56:46][RANK 0][INFO] Starting validation...
[2025-10-16 23:04:36][RANK 0][INFO] EPOCH 3 SUMMARY: Val Loss: 0.4687 | Val Acc: 0.8469
[2025-10-16 23:04:36][RANK 0][INFO] New best val_acc: 0.8469. Saving model...
[2025-10-16 23:04:37][RANK 0][INFO] Starting Epoch 4/35
[2025-10-16 23:48:04][RANK 0][INFO] Starting validation...
[2025-10-16 23:56:01][RANK 0][INFO] EPOCH 4 SUMMARY: Val Loss: 0.4286 | Val Acc: 0.8571
[2025-10-16 23:56:01][RANK 0][INFO] New best val_acc: 0.8571. Saving model...
[2025-10-16 23:56:02][RANK 0][INFO] Starting Epoch 5/35
[2025-10-17 00:39:54][RANK 0][INFO] Starting validation...
[2025-10-17 00:48:17][RANK 0][INFO] EPOCH 5 SUMMARY: Val Loss: 0.3674 | Val Acc: 0.8738
[2025-10-17 00:48:17][RANK 0][INFO] New best val_acc: 0.8738. Saving model...
[2025-10-17 00:48:18][RANK 0][INFO] Starting Epoch 6/35
[2025-10-17 01:31:54][RANK 0][INFO] Starting validation...
[2025-10-17 01:39:29][RANK 0][INFO] EPOCH 6 SUMMARY: Val Loss: 0.3415 | Val Acc: 0.8889
[2025-10-17 01:39:29][RANK 0][INFO] New best val_acc: 0.8889. Saving model...
[2025-10-17 01:39:30][RANK 0][INFO] Starting Epoch 7/35
[2025-10-17 02:23:19][RANK 0][INFO] Starting validation...
[2025-10-17 02:32:08][RANK 0][INFO] EPOCH 7 SUMMARY: Val Loss: 0.3644 | Val Acc: 0.8777
[2025-10-17 02:32:09][RANK 0][INFO] Starting Epoch 8/35
[2025-10-17 03:15:56][RANK 0][INFO] Starting validation...
[2025-10-17 03:23:23][RANK 0][INFO] EPOCH 8 SUMMARY: Val Loss: 0.3489 | Val Acc: 0.8826
[2025-10-17 03:23:24][RANK 0][INFO] Starting Epoch 9/35
[2025-10-17 04:07:09][RANK 0][INFO] Starting validation...
[2025-10-17 04:15:47][RANK 0][INFO] EPOCH 9 SUMMARY: Val Loss: 0.3625 | Val Acc: 0.8802
[2025-10-17 04:15:48][RANK 0][INFO] Starting Epoch 10/35
[2025-10-17 04:59:43][RANK 0][INFO] Starting validation...
[2025-10-17 05:07:38][RANK 0][INFO] EPOCH 10 SUMMARY: Val Loss: 0.3537 | Val Acc: 0.8809
[2025-10-17 05:07:39][RANK 0][INFO] Starting Epoch 11/35
[2025-10-17 05:51:29][RANK 0][INFO] Starting validation...
[2025-10-17 05:59:36][RANK 0][INFO] EPOCH 11 SUMMARY: Val Loss: 0.3886 | Val Acc: 0.8657
[2025-10-17 05:59:37][RANK 0][INFO] Starting Epoch 12/35
[2025-10-17 06:44:22][RANK 0][INFO] Starting validation...
[2025-10-17 06:52:40][RANK 0][INFO] EPOCH 12 SUMMARY: Val Loss: 0.3280 | Val Acc: 0.8960
[2025-10-17 06:52:40][RANK 0][INFO] New best val_acc: 0.8960. Saving model...
[2025-10-17 06:52:42][RANK 0][INFO] Starting Epoch 13/35
[2025-10-17 07:36:43][RANK 0][INFO] Starting validation...
[2025-10-17 07:44:32][RANK 0][INFO] EPOCH 13 SUMMARY: Val Loss: 0.3721 | Val Acc: 0.8714
[2025-10-17 07:44:33][RANK 0][INFO] Starting Epoch 14/35
[2025-10-17 08:28:48][RANK 0][INFO] Starting validation...
[2025-10-17 08:37:35][RANK 0][INFO] EPOCH 14 SUMMARY: Val Loss: 0.3409 | Val Acc: 0.8927
[2025-10-17 08:37:36][RANK 0][INFO] Starting Epoch 15/35
[2025-10-17 08:57:20][RANK 0][ERROR] An unhandled exception occurred on RANK 0: [Errno 32] Broken pipe
[2025-10-17 08:57:20][RANK 0][ERROR] Traceback (most recent call last):
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0034/container_1759911303345_0034_02_000002/project.zip/project/data/data_loader.py", line 62, in __iter__
    torch.tensor(pydict["scaled_features"], dtype=torch.float32),
RuntimeError: unknown parameter type

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0034/container_1759911303345_0034_02_000002/project.zip/project/training/trainer.py", line 92, in training_function
    for i, (features, labels, weights) in enumerate(
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0034/container_1759911303345_0034_02_000002/project.zip/project/data/data_loader.py", line 68, in __iter__
    print(
BrokenPipeError: [Errno 32] Broken pipe

[2025-10-26 18:28:17][RANK 0][INFO] Initializing Dataloaders...
[2025-10-26 18:28:17][RANK 0][INFO] Dataloaders initialized.
[2025-10-26 18:28:18][RANK 0][INFO] Starting training for RNN model...
[2025-10-26 18:28:18][RANK 0][INFO] Starting Epoch 1/35
[2025-10-26 19:08:45][RANK 0][INFO] Starting validation...
[2025-10-26 19:15:49][RANK 0][INFO] EPOCH 1 SUMMARY: Val Loss: 0.5136 | Val Acc: 0.8147
[2025-10-26 19:15:49][RANK 0][INFO] New best val_acc: 0.8147. Saving model...
[2025-10-26 19:15:51][RANK 0][INFO] Starting Epoch 2/35
[2025-10-26 19:56:05][RANK 0][INFO] Starting validation...
[2025-10-26 20:03:45][RANK 0][INFO] EPOCH 2 SUMMARY: Val Loss: 0.4622 | Val Acc: 0.8517
[2025-10-26 20:03:45][RANK 0][INFO] New best val_acc: 0.8517. Saving model...
[2025-10-26 20:03:46][RANK 0][INFO] Starting Epoch 3/35
[2025-10-26 20:45:42][RANK 0][INFO] Starting validation...
[2025-10-26 20:52:52][RANK 0][INFO] EPOCH 3 SUMMARY: Val Loss: 0.3250 | Val Acc: 0.8953
[2025-10-26 20:52:52][RANK 0][INFO] New best val_acc: 0.8953. Saving model...
[2025-10-26 20:52:54][RANK 0][INFO] Starting Epoch 4/35
[2025-10-26 21:32:54][RANK 0][INFO] Starting validation...
[2025-10-26 21:40:41][RANK 0][INFO] EPOCH 4 SUMMARY: Val Loss: 0.3876 | Val Acc: 0.8661
[2025-10-26 21:40:42][RANK 0][INFO] Starting Epoch 5/35
[2025-10-26 22:22:40][RANK 0][INFO] Starting validation...
[2025-10-26 22:30:12][RANK 0][INFO] EPOCH 5 SUMMARY: Val Loss: 0.3886 | Val Acc: 0.8679
[2025-10-26 22:30:13][RANK 0][INFO] Starting Epoch 6/35
[2025-10-26 23:10:25][RANK 0][INFO] Starting validation...
[2025-10-26 23:18:06][RANK 0][INFO] EPOCH 6 SUMMARY: Val Loss: 0.4707 | Val Acc: 0.8448
[2025-10-26 23:18:07][RANK 0][INFO] Starting Epoch 7/35
[2025-10-27 00:00:09][RANK 0][INFO] Starting validation...
[2025-10-27 00:07:55][RANK 0][INFO] EPOCH 7 SUMMARY: Val Loss: 0.3382 | Val Acc: 0.8993
[2025-10-27 00:07:55][RANK 0][INFO] New best val_acc: 0.8993. Saving model...
[2025-10-27 00:07:57][RANK 0][INFO] Starting Epoch 8/35
[2025-10-27 00:47:43][RANK 0][INFO] Starting validation...
[2025-10-27 00:55:28][RANK 0][INFO] EPOCH 8 SUMMARY: Val Loss: 0.3433 | Val Acc: 0.9068
[2025-10-27 00:55:28][RANK 0][INFO] New best val_acc: 0.9068. Saving model...
[2025-10-27 00:55:29][RANK 0][INFO] Starting Epoch 9/35
[2025-10-27 01:37:56][RANK 0][INFO] Starting validation...
[2025-10-27 01:45:48][RANK 0][INFO] EPOCH 9 SUMMARY: Val Loss: 0.3253 | Val Acc: 0.8988
[2025-10-27 01:45:49][RANK 0][INFO] Starting Epoch 10/35
[2025-10-27 02:25:31][RANK 0][INFO] Starting validation...
[2025-10-27 02:33:23][RANK 0][INFO] EPOCH 10 SUMMARY: Val Loss: 0.3154 | Val Acc: 0.9017
[2025-10-27 02:33:24][RANK 0][INFO] Starting Epoch 11/35
[2025-10-27 03:15:40][RANK 0][INFO] Starting validation...
[2025-10-27 03:23:30][RANK 0][INFO] EPOCH 11 SUMMARY: Val Loss: 0.3266 | Val Acc: 0.9003
[2025-10-27 03:23:31][RANK 0][INFO] Starting Epoch 12/35
[2025-10-27 04:02:58][RANK 0][INFO] Starting validation...
[2025-10-27 04:10:49][RANK 0][INFO] EPOCH 12 SUMMARY: Val Loss: 0.3529 | Val Acc: 0.8793
[2025-10-27 04:10:50][RANK 0][INFO] Starting Epoch 13/35
[2025-10-27 04:52:48][RANK 0][INFO] Starting validation...
[2025-10-27 05:00:38][RANK 0][INFO] EPOCH 13 SUMMARY: Val Loss: 0.3348 | Val Acc: 0.8858
[2025-10-27 05:00:39][RANK 0][INFO] Starting Epoch 14/35
[2025-10-27 05:40:30][RANK 0][INFO] Starting validation...
[2025-10-27 05:47:49][RANK 0][INFO] EPOCH 14 SUMMARY: Val Loss: 0.3134 | Val Acc: 0.9006
[2025-10-27 05:47:50][RANK 0][INFO] Starting Epoch 15/35
[2025-10-27 06:30:01][RANK 0][INFO] Starting validation...
[2025-10-27 06:37:54][RANK 0][INFO] EPOCH 15 SUMMARY: Val Loss: 0.3146 | Val Acc: 0.8980
[2025-10-27 06:37:55][RANK 0][INFO] Starting Epoch 16/35
[2025-10-27 07:18:25][RANK 0][INFO] Starting validation...
[2025-10-27 07:25:36][RANK 0][INFO] EPOCH 16 SUMMARY: Val Loss: 0.3288 | Val Acc: 0.8884
[2025-10-27 07:25:37][RANK 0][INFO] Starting Epoch 17/35
[2025-10-27 08:07:55][RANK 0][INFO] Starting validation...
[2025-10-27 08:15:48][RANK 0][INFO] EPOCH 17 SUMMARY: Val Loss: 0.3068 | Val Acc: 0.9070
[2025-10-27 08:15:48][RANK 0][INFO] New best val_acc: 0.9070. Saving model...
[2025-10-27 08:15:50][RANK 0][INFO] Starting Epoch 18/35
[2025-10-27 08:56:52][RANK 0][INFO] Starting validation...
[2025-10-27 09:04:14][RANK 0][INFO] EPOCH 18 SUMMARY: Val Loss: 0.3248 | Val Acc: 0.8884
[2025-10-27 09:04:15][RANK 0][INFO] Starting Epoch 19/35
[2025-10-27 09:46:13][RANK 0][INFO] Starting validation...
[2025-10-27 09:54:09][RANK 0][INFO] EPOCH 19 SUMMARY: Val Loss: 0.3105 | Val Acc: 0.8991
[2025-10-27 09:54:11][RANK 0][INFO] Starting Epoch 20/35
[2025-10-27 10:35:26][RANK 0][INFO] Starting validation...
[2025-10-27 10:42:47][RANK 0][INFO] EPOCH 20 SUMMARY: Val Loss: 0.2986 | Val Acc: 0.9074
[2025-10-27 10:42:47][RANK 0][INFO] New best val_acc: 0.9074. Saving model...
[2025-10-27 10:42:48][RANK 0][INFO] Starting Epoch 21/35
[2025-10-27 11:24:13][RANK 0][INFO] Starting validation...
[2025-10-27 11:32:07][RANK 0][INFO] EPOCH 21 SUMMARY: Val Loss: 0.3231 | Val Acc: 0.8933
[2025-10-27 11:32:08][RANK 0][INFO] Starting Epoch 22/35
[2025-10-27 12:13:50][RANK 0][INFO] Starting validation...
[2025-10-27 12:21:11][RANK 0][INFO] EPOCH 22 SUMMARY: Val Loss: 0.3399 | Val Acc: 0.8797
[2025-10-27 12:21:12][RANK 0][INFO] Starting Epoch 23/35
[2025-10-27 13:02:07][RANK 0][INFO] Starting validation...
[2025-10-27 13:10:03][RANK 0][INFO] EPOCH 23 SUMMARY: Val Loss: 0.3112 | Val Acc: 0.9019
[2025-10-27 13:10:04][RANK 0][INFO] Starting Epoch 24/35
[2025-10-27 13:52:34][RANK 0][INFO] Starting validation...
[2025-10-27 13:59:54][RANK 0][INFO] EPOCH 24 SUMMARY: Val Loss: 0.3256 | Val Acc: 0.8916
[2025-10-27 13:59:55][RANK 0][INFO] Starting Epoch 25/35
[2025-10-27 14:40:52][RANK 0][INFO] Starting validation...
[2025-10-27 14:48:42][RANK 0][INFO] EPOCH 25 SUMMARY: Val Loss: 0.3128 | Val Acc: 0.9043
[2025-10-27 14:48:43][RANK 0][INFO] Starting Epoch 26/35
[2025-10-27 15:31:11][RANK 0][INFO] Starting validation...
[2025-10-27 15:38:25][RANK 0][INFO] EPOCH 26 SUMMARY: Val Loss: 0.3075 | Val Acc: 0.9012
[2025-10-27 15:38:27][RANK 0][INFO] Starting Epoch 27/35
[2025-10-27 16:18:39][RANK 0][INFO] Starting validation...
[2025-10-27 16:26:30][RANK 0][INFO] EPOCH 27 SUMMARY: Val Loss: 0.3000 | Val Acc: 0.9058
[2025-10-27 16:26:31][RANK 0][INFO] Starting Epoch 28/35
[2025-10-27 17:08:57][RANK 0][INFO] Starting validation...
[2025-10-27 17:16:38][RANK 0][INFO] EPOCH 28 SUMMARY: Val Loss: 0.3187 | Val Acc: 0.8960
[2025-10-27 17:16:39][RANK 0][INFO] Starting Epoch 29/35
[2025-10-27 17:57:12][RANK 0][INFO] Starting validation...
[2025-10-27 18:05:03][RANK 0][INFO] EPOCH 29 SUMMARY: Val Loss: 0.3278 | Val Acc: 0.8923
[2025-10-27 18:05:05][RANK 0][INFO] Starting Epoch 30/35
[2025-10-27 18:47:41][RANK 0][INFO] Starting validation...
[2025-10-27 18:55:33][RANK 0][INFO] EPOCH 30 SUMMARY: Val Loss: 0.3361 | Val Acc: 0.8871
[2025-10-27 18:55:35][RANK 0][INFO] Starting Epoch 31/35
[2025-10-27 19:35:28][RANK 0][INFO] Starting validation...
[2025-10-27 19:43:21][RANK 0][INFO] EPOCH 31 SUMMARY: Val Loss: 0.3104 | Val Acc: 0.9018
[2025-10-27 19:43:23][RANK 0][INFO] Starting Epoch 32/35
[2025-10-27 20:26:04][RANK 0][INFO] Starting validation...
[2025-10-27 20:33:56][RANK 0][INFO] EPOCH 32 SUMMARY: Val Loss: 0.3093 | Val Acc: 0.8992
[2025-10-27 20:33:57][RANK 0][INFO] Starting Epoch 33/35
[2025-10-27 21:13:47][RANK 0][INFO] Starting validation...
[2025-10-27 21:21:37][RANK 0][INFO] EPOCH 33 SUMMARY: Val Loss: 0.3221 | Val Acc: 0.8999
[2025-10-27 21:21:38][RANK 0][INFO] Starting Epoch 34/35
[2025-10-27 22:04:08][RANK 0][INFO] Starting validation...
[2025-10-27 22:12:03][RANK 0][INFO] EPOCH 34 SUMMARY: Val Loss: 0.3116 | Val Acc: 0.9043
[2025-10-27 22:12:04][RANK 0][INFO] Starting Epoch 35/35
[2025-10-27 22:51:39][RANK 0][INFO] Starting validation...
[2025-10-27 22:59:36][RANK 0][INFO] EPOCH 35 SUMMARY: Val Loss: 0.3008 | Val Acc: 0.9027
[2025-10-27 22:59:37][RANK 0][INFO] Uploading model from /tmp/model_upload to hdfs://master:9000/usr/ubuntu/rnn_client_20251026_181157
