[2025-10-16 10:58:15][RANK 0][INFO] Initializing Dataloaders...
[2025-10-16 10:58:15][RANK 0][INFO] Dataloaders initialized.
[2025-10-16 10:58:17][RANK 0][INFO] Starting training for GRU model...
[2025-10-16 10:58:17][RANK 0][INFO] Starting Epoch 1/100
[2025-10-16 12:24:38][RANK 0][INFO] Starting validation...
[2025-10-16 12:36:13][RANK 0][INFO] EPOCH 1 SUMMARY: Val Loss: 0.7424 | Val Acc: 0.7374
[2025-10-16 12:36:13][RANK 0][INFO] New best val_acc: 0.7374. Saving model...
[2025-10-16 12:36:15][RANK 0][INFO] Starting Epoch 2/100
[2025-10-16 14:01:05][RANK 0][INFO] Starting validation...
[2025-10-16 14:12:22][RANK 0][INFO] EPOCH 2 SUMMARY: Val Loss: 0.6294 | Val Acc: 0.7506
[2025-10-16 14:12:22][RANK 0][INFO] New best val_acc: 0.7506. Saving model...
[2025-10-16 14:12:24][RANK 0][INFO] Starting Epoch 3/100
[2025-10-16 15:37:03][RANK 0][INFO] Starting validation...
[2025-10-16 15:48:07][RANK 0][INFO] EPOCH 3 SUMMARY: Val Loss: 0.5323 | Val Acc: 0.7650
[2025-10-16 15:48:07][RANK 0][INFO] New best val_acc: 0.7650. Saving model...
[2025-10-16 15:48:08][RANK 0][INFO] Starting Epoch 4/100
[2025-10-16 17:13:55][RANK 0][INFO] Starting validation...
[2025-10-16 17:25:02][RANK 0][INFO] EPOCH 4 SUMMARY: Val Loss: 0.5869 | Val Acc: 0.7785
[2025-10-16 17:25:02][RANK 0][INFO] New best val_acc: 0.7785. Saving model...
[2025-10-16 17:25:03][RANK 0][INFO] Starting Epoch 5/100
[2025-10-16 18:50:24][RANK 0][INFO] Starting validation...
[2025-10-16 19:01:20][RANK 0][INFO] EPOCH 5 SUMMARY: Val Loss: 0.6638 | Val Acc: 0.7577
[2025-10-16 19:01:21][RANK 0][INFO] Starting Epoch 6/100
[2025-10-16 19:36:59][RANK 0][ERROR] An unhandled exception occurred on RANK 0: [Errno 32] Broken pipe
[2025-10-16 19:36:59][RANK 0][ERROR] Traceback (most recent call last):
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0007/container_1759911303345_0007_01_000002/project.zip/project/data/data_loader.py", line 62, in __iter__
    torch.tensor(pydict["scaled_features"], dtype=torch.float32),
TypeError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0007/container_1759911303345_0007_01_000002/project.zip/project/training/trainer.py", line 92, in training_function
    for i, (features, labels, weights) in enumerate(
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ubuntu/spark_env/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 42, in fetch
    data = next(self.dataset_iter)
  File "/usr/local/hadoop/tmp/nm-local-dir/usercache/ubuntu/appcache/application_1759911303345_0007/container_1759911303345_0007_01_000002/project.zip/project/data/data_loader.py", line 68, in __iter__
    print(
BrokenPipeError: [Errno 32] Broken pipe

[2025-10-26 18:30:37][RANK 0][INFO] Initializing Dataloaders...
[2025-10-26 18:30:37][RANK 0][INFO] Dataloaders initialized.
[2025-10-26 18:30:38][RANK 0][INFO] Starting training for GRU model...
[2025-10-26 18:30:38][RANK 0][INFO] Starting Epoch 1/35
[2025-10-26 19:55:44][RANK 0][INFO] Starting validation...
[2025-10-26 20:07:21][RANK 0][INFO] EPOCH 1 SUMMARY: Val Loss: 0.4943 | Val Acc: 0.7833
[2025-10-26 20:07:21][RANK 0][INFO] New best val_acc: 0.7833. Saving model...
[2025-10-26 20:07:23][RANK 0][INFO] Starting Epoch 2/35
[2025-10-26 21:31:31][RANK 0][INFO] Starting validation...
[2025-10-26 21:43:06][RANK 0][INFO] EPOCH 2 SUMMARY: Val Loss: 0.3070 | Val Acc: 0.8929
[2025-10-26 21:43:06][RANK 0][INFO] New best val_acc: 0.8929. Saving model...
[2025-10-26 21:43:08][RANK 0][INFO] Starting Epoch 3/35
[2025-10-26 23:07:19][RANK 0][INFO] Starting validation...
[2025-10-26 23:18:53][RANK 0][INFO] EPOCH 3 SUMMARY: Val Loss: 0.3485 | Val Acc: 0.8974
[2025-10-26 23:18:53][RANK 0][INFO] New best val_acc: 0.8974. Saving model...
[2025-10-26 23:18:54][RANK 0][INFO] Starting Epoch 4/35
[2025-10-27 00:42:57][RANK 0][INFO] Starting validation...
[2025-10-27 00:54:34][RANK 0][INFO] EPOCH 4 SUMMARY: Val Loss: 0.3212 | Val Acc: 0.9103
[2025-10-27 00:54:34][RANK 0][INFO] New best val_acc: 0.9103. Saving model...
[2025-10-27 00:54:35][RANK 0][INFO] Starting Epoch 5/35
[2025-10-27 02:19:13][RANK 0][INFO] Starting validation...
[2025-10-27 02:30:30][RANK 0][INFO] EPOCH 5 SUMMARY: Val Loss: 0.3326 | Val Acc: 0.8939
[2025-10-27 02:30:31][RANK 0][INFO] Starting Epoch 6/35
[2025-10-27 03:55:54][RANK 0][INFO] Starting validation...
[2025-10-27 04:06:43][RANK 0][INFO] EPOCH 6 SUMMARY: Val Loss: 0.3449 | Val Acc: 0.8712
[2025-10-27 04:06:44][RANK 0][INFO] Starting Epoch 7/35
[2025-10-27 05:32:46][RANK 0][INFO] Starting validation...
[2025-10-27 05:43:13][RANK 0][INFO] EPOCH 7 SUMMARY: Val Loss: 0.3663 | Val Acc: 0.9064
[2025-10-27 05:43:14][RANK 0][INFO] Starting Epoch 8/35
[2025-10-27 07:09:43][RANK 0][INFO] Starting validation...
[2025-10-27 07:20:09][RANK 0][INFO] EPOCH 8 SUMMARY: Val Loss: 0.2749 | Val Acc: 0.8887
[2025-10-27 07:20:10][RANK 0][INFO] Starting Epoch 9/35
[2025-10-27 08:46:28][RANK 0][INFO] Starting validation...
[2025-10-27 08:56:54][RANK 0][INFO] EPOCH 9 SUMMARY: Val Loss: 0.2852 | Val Acc: 0.8965
[2025-10-27 08:56:55][RANK 0][INFO] Starting Epoch 10/35
[2025-10-27 10:23:04][RANK 0][INFO] Starting validation...
[2025-10-27 10:33:35][RANK 0][INFO] EPOCH 10 SUMMARY: Val Loss: 0.2873 | Val Acc: 0.8842
[2025-10-27 10:33:36][RANK 0][INFO] Starting Epoch 11/35
[2025-10-27 11:59:11][RANK 0][INFO] Starting validation...
[2025-10-27 12:10:14][RANK 0][INFO] EPOCH 11 SUMMARY: Val Loss: 0.2930 | Val Acc: 0.8948
[2025-10-27 12:10:15][RANK 0][INFO] Starting Epoch 12/35
[2025-10-27 13:35:19][RANK 0][INFO] Starting validation...
[2025-10-27 13:46:49][RANK 0][INFO] EPOCH 12 SUMMARY: Val Loss: 0.2699 | Val Acc: 0.8918
[2025-10-27 13:46:50][RANK 0][INFO] Starting Epoch 13/35
[2025-10-27 15:11:36][RANK 0][INFO] Starting validation...
[2025-10-27 15:23:12][RANK 0][INFO] EPOCH 13 SUMMARY: Val Loss: 0.2807 | Val Acc: 0.9135
[2025-10-27 15:23:12][RANK 0][INFO] New best val_acc: 0.9135. Saving model...
[2025-10-27 15:23:13][RANK 0][INFO] Starting Epoch 14/35
[2025-10-27 16:47:46][RANK 0][INFO] Starting validation...
[2025-10-27 16:59:20][RANK 0][INFO] EPOCH 14 SUMMARY: Val Loss: 0.2735 | Val Acc: 0.9182
[2025-10-27 16:59:20][RANK 0][INFO] New best val_acc: 0.9182. Saving model...
[2025-10-27 16:59:22][RANK 0][INFO] Starting Epoch 15/35
[2025-10-27 18:24:15][RANK 0][INFO] Starting validation...
[2025-10-27 18:35:59][RANK 0][INFO] EPOCH 15 SUMMARY: Val Loss: 0.2972 | Val Acc: 0.8890
[2025-10-27 18:36:00][RANK 0][INFO] Starting Epoch 16/35
[2025-10-27 20:01:08][RANK 0][INFO] Starting validation...
[2025-10-27 20:12:52][RANK 0][INFO] EPOCH 16 SUMMARY: Val Loss: 0.3673 | Val Acc: 0.9010
[2025-10-27 20:12:53][RANK 0][INFO] Starting Epoch 17/35
[2025-10-27 21:37:37][RANK 0][INFO] Starting validation...
[2025-10-27 21:49:17][RANK 0][INFO] EPOCH 17 SUMMARY: Val Loss: 0.3539 | Val Acc: 0.9023
[2025-10-27 21:49:18][RANK 0][INFO] Starting Epoch 18/35
[2025-10-27 23:14:10][RANK 0][INFO] Starting validation...
[2025-10-27 23:25:46][RANK 0][INFO] EPOCH 18 SUMMARY: Val Loss: 0.3443 | Val Acc: 0.9108
[2025-10-27 23:25:48][RANK 0][INFO] Starting Epoch 19/35
[2025-10-28 00:50:53][RANK 0][INFO] Starting validation...
[2025-10-28 01:02:34][RANK 0][INFO] EPOCH 19 SUMMARY: Val Loss: 0.3510 | Val Acc: 0.8888
[2025-10-28 01:02:35][RANK 0][INFO] Starting Epoch 20/35
[2025-10-28 02:28:01][RANK 0][INFO] Starting validation...
[2025-10-28 02:39:37][RANK 0][INFO] EPOCH 20 SUMMARY: Val Loss: 0.3943 | Val Acc: 0.8825
[2025-10-28 02:39:38][RANK 0][INFO] Starting Epoch 21/35
[2025-10-28 04:04:39][RANK 0][INFO] Starting validation...
[2025-10-28 04:16:18][RANK 0][INFO] EPOCH 21 SUMMARY: Val Loss: 0.2581 | Val Acc: 0.9081
[2025-10-28 04:16:19][RANK 0][INFO] Starting Epoch 22/35
[2025-10-28 05:41:24][RANK 0][INFO] Starting validation...
[2025-10-28 05:53:04][RANK 0][INFO] EPOCH 22 SUMMARY: Val Loss: 0.3484 | Val Acc: 0.9111
[2025-10-28 05:53:05][RANK 0][INFO] Starting Epoch 23/35
[2025-10-28 07:21:55][RANK 0][INFO] Starting validation...
[2025-10-28 07:33:31][RANK 0][INFO] EPOCH 23 SUMMARY: Val Loss: 0.4805 | Val Acc: 0.9148
[2025-10-28 07:33:32][RANK 0][INFO] Starting Epoch 24/35
[2025-10-28 09:00:25][RANK 0][INFO] Starting validation...
[2025-10-28 09:11:34][RANK 0][INFO] EPOCH 24 SUMMARY: Val Loss: 0.2500 | Val Acc: 0.9183
[2025-10-28 09:11:34][RANK 0][INFO] New best val_acc: 0.9183. Saving model...
[2025-10-28 09:11:36][RANK 0][INFO] Starting Epoch 25/35
[2025-10-28 10:42:33][RANK 0][INFO] Starting validation...
[2025-10-28 10:53:13][RANK 0][INFO] EPOCH 25 SUMMARY: Val Loss: 0.2668 | Val Acc: 0.9031
[2025-10-28 10:53:14][RANK 0][INFO] Starting Epoch 26/35
[2025-10-28 12:21:15][RANK 0][INFO] Starting validation...
[2025-10-28 12:32:02][RANK 0][INFO] EPOCH 26 SUMMARY: Val Loss: 0.3146 | Val Acc: 0.9038
[2025-10-28 12:32:04][RANK 0][INFO] Starting Epoch 27/35
[2025-10-28 13:59:46][RANK 0][INFO] Starting validation...
[2025-10-28 14:10:31][RANK 0][INFO] EPOCH 27 SUMMARY: Val Loss: 0.3492 | Val Acc: 0.8854
[2025-10-28 14:10:33][RANK 0][INFO] Starting Epoch 28/35
[2025-10-28 15:38:23][RANK 0][INFO] Starting validation...
[2025-10-28 15:48:59][RANK 0][INFO] EPOCH 28 SUMMARY: Val Loss: 0.3717 | Val Acc: 0.8833
[2025-10-28 15:49:00][RANK 0][INFO] Starting Epoch 29/35
[2025-10-28 17:16:55][RANK 0][INFO] Starting validation...
[2025-10-28 17:27:29][RANK 0][INFO] EPOCH 29 SUMMARY: Val Loss: 0.2964 | Val Acc: 0.9011
[2025-10-28 17:27:31][RANK 0][INFO] Starting Epoch 30/35
[2025-10-28 18:55:23][RANK 0][INFO] Starting validation...
[2025-10-28 19:06:03][RANK 0][INFO] EPOCH 30 SUMMARY: Val Loss: 0.2777 | Val Acc: 0.9145
[2025-10-28 19:06:04][RANK 0][INFO] Starting Epoch 31/35
[2025-10-28 20:33:23][RANK 0][INFO] Starting validation...
[2025-10-28 20:44:26][RANK 0][INFO] EPOCH 31 SUMMARY: Val Loss: 0.2871 | Val Acc: 0.9028
[2025-10-28 20:44:27][RANK 0][INFO] Starting Epoch 32/35
[2025-10-28 22:10:54][RANK 0][INFO] Starting validation...
[2025-10-28 22:22:32][RANK 0][INFO] EPOCH 32 SUMMARY: Val Loss: 0.2815 | Val Acc: 0.8904
[2025-10-28 22:22:33][RANK 0][INFO] Starting Epoch 33/35
[2025-10-28 23:48:56][RANK 0][INFO] Starting validation...
[2025-10-29 00:00:43][RANK 0][INFO] EPOCH 33 SUMMARY: Val Loss: 0.2797 | Val Acc: 0.9121
[2025-10-29 00:00:45][RANK 0][INFO] Starting Epoch 34/35
[2025-10-29 01:26:46][RANK 0][INFO] Starting validation...
[2025-10-29 01:38:32][RANK 0][INFO] EPOCH 34 SUMMARY: Val Loss: 0.2602 | Val Acc: 0.8877
[2025-10-29 01:38:34][RANK 0][INFO] Starting Epoch 35/35
[2025-10-29 03:04:23][RANK 0][INFO] Starting validation...
[2025-10-29 03:16:15][RANK 0][INFO] EPOCH 35 SUMMARY: Val Loss: 0.2902 | Val Acc: 0.9030
[2025-10-29 03:16:17][RANK 0][INFO] Uploading model from /tmp/model_upload to hdfs://master:9000/usr/ubuntu/gru_client_20251026_181311
